(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{51326:function(e,t,a){Promise.resolve().then(a.bind(a,9137))},9137:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var s=a(57437),i=a(2265),n=a(99376),l=a(11713),r=a(71837),o=a(1217),d=a(15863),c=a(42208),u=a(89345),m=a(70525),x=a(95252),p=a(40521),y=a(47625),h=a(21156),v=a(56940),g=a(97059),f=a(62994),b=a(8147),j=a(22190),N=a(54061),w=a(75169),S=a(3574),F=a(20407),A=a(77031),E=a(31699);let k=["#5B5F97","#8BD3DD","#6EC1A6","#F9C97A","#EF7C79"];function P(){let e=(0,n.useRouter)(),{isAuthenticated:t,user:a}=(0,o.t)(),[P,B]=(0,i.useState)("30d");(0,i.useEffect)(()=>{t&&(null==a?void 0:a.role)==="admin"||e.push("/")},[t,a,e]);let{data:T,isLoading:C,error:D}=(0,l.a)({queryKey:["admin-analytics",P],queryFn:async()=>(await r.Nq.getAnalytics({dateRange:P})).data,enabled:t&&(null==a?void 0:a.role)==="admin",retry:1});if(C)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(d.Z,{className:"animate-spin text-accent-primary",size:32})});if(D||!T)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-soft p-6",children:(0,s.jsx)("div",{className:"container mx-auto max-w-7xl",children:(0,s.jsxs)("div",{className:"card-luxury p-6 text-center",children:[(0,s.jsx)("p",{className:"text-text-secondary text-lg",children:"No analytics data available."}),(0,s.jsx)("p",{className:"text-text-secondary text-sm mt-2",children:"Please try again later."})]})})});let I=(null==T?void 0:T.viewsTrend)||[],L=(null==T?void 0:T.leadsTrend)||[],R=(null==T?void 0:T.leadStatusBreakdown)||[],U=(null==T?void 0:T.topPropertiesByViews)||[],z=(null==T?void 0:T.locationStats)||{},O=I.reduce((e,t)=>e+Number(t.count||t.views||0),0),q=L.reduce((e,t)=>e+Number(t.count||0),0),_=U.reduce((e,t)=>e+Number(t.conversions||0),0),K=U.length,V=I.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),views:Number(e.count||e.views||0)})),Z=R.length>0?R.map(e=>({name:e.status||"Unknown",value:Number(e.count||0)})):[{name:"Pending",value:0},{name:"Contacted",value:0},{name:"Converted",value:0},{name:"Lost",value:0}],W=L.map(e=>({date:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),leads:Number(e.count||0)})),J=Object.entries(z).map(e=>{let[t,a]=e;return{city:t,count:a}});return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-soft p-6",children:(0,s.jsxs)("div",{className:"max-w-[1280px] mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-display font-bold text-text-primary mb-2",children:"Analytics Dashboard"}),(0,s.jsx)("p",{className:"text-text-secondary",children:"Detailed analytics and insights"})]}),(0,s.jsxs)("select",{value:P,onChange:e=>B(e.target.value),className:"input-elegant",children:[(0,s.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,s.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,s.jsx)("option",{value:"90d",children:"Last 90 days"}),(0,s.jsx)("option",{value:"all",children:"All time"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card-luxury p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)(c.Z,{className:"text-accent-primary",size:24})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-text-primary mb-1",children:O.toLocaleString()}),(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:"Total Views"})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card-luxury p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)(u.Z,{className:"text-success",size:24})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-text-primary mb-1",children:q.toLocaleString()}),(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:"Total Inquiries"})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card-luxury p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)(m.Z,{className:"text-warning",size:24})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-text-primary mb-1",children:_.toLocaleString()}),(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:"Total Conversions"})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card-luxury p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)(x.Z,{className:"text-error",size:24})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-text-primary mb-1",children:K}),(0,s.jsx)("p",{className:"text-text-secondary text-sm",children:"Properties Tracked"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card-luxury p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-display font-bold text-text-primary mb-4",children:"Property Views Over Time"}),(0,s.jsx)(y.h,{width:"100%",height:300,children:(0,s.jsxs)(h.w,{data:V,children:[(0,s.jsx)(v.q,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),(0,s.jsx)(g.K,{dataKey:"date",stroke:"#5F6B7A",fontSize:12}),(0,s.jsx)(f.B,{stroke:"#5F6B7A",fontSize:12}),(0,s.jsx)(b.u,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px"}}),(0,s.jsx)(j.D,{}),(0,s.jsx)(N.x,{type:"monotone",dataKey:"views",stroke:"#5B5F97",strokeWidth:2,dot:{fill:"#5B5F97",r:4},name:"Views"})]})})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card-luxury p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-display font-bold text-text-primary mb-4",children:"Lead Status Breakdown"}),Z.some(e=>e.value>0)?(0,s.jsx)(y.h,{width:"100%",height:300,children:(0,s.jsxs)(w.u,{children:[(0,s.jsx)(S.b,{data:Z,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:a}=e;return"".concat(t," ").concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:Z.map((e,t)=>(0,s.jsx)(F.b,{fill:k[t%k.length]},"cell-".concat(t)))}),(0,s.jsx)(b.u,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px"}})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[300px] text-text-secondary text-sm",children:"No lead data available yet."})]})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card-luxury p-6 mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-display font-bold text-text-primary mb-4",children:"Leads Over Time"}),W.length>0?(0,s.jsx)(y.h,{width:"100%",height:300,children:(0,s.jsxs)(A.v,{data:W,children:[(0,s.jsx)(v.q,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),(0,s.jsx)(g.K,{dataKey:"date",stroke:"#5F6B7A",fontSize:12}),(0,s.jsx)(f.B,{stroke:"#5F6B7A",fontSize:12}),(0,s.jsx)(b.u,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px"}}),(0,s.jsx)(j.D,{}),(0,s.jsx)(E.$,{dataKey:"leads",fill:"#8BD3DD",name:"Leads",radius:[8,8,0,0]})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-[300px] text-text-secondary text-sm",children:"No lead activity recorded for this period."})]}),(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card-luxury p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-display font-bold text-text-primary mb-6",children:"Property Analytics"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-border",children:[(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Property ID"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Title"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Views"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Inquiries"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Conversions"})]})}),(0,s.jsx)("tbody",{children:U.length>0?U.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-border hover:bg-surface-muted",children:[(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.id}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.title||"Untitled"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.views||0}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.inquiries||0}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.conversions||0})]},e.id||t)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:4,className:"py-8 text-center text-text-secondary",children:"No analytics data available"})})})]})})]}),J.length>0&&(0,s.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card-luxury p-6 mt-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-display font-bold text-text-primary mb-4",children:"Active Locations"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:J.map(e=>{let{city:t,count:a}=e;return(0,s.jsxs)("div",{className:"p-4 rounded-lg bg-surface-muted border border-border flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-text-primary font-semibold",children:t}),(0,s.jsxs)("span",{className:"text-text-secondary text-sm",children:[a," properties"]})]},t)})})]})]})})}},71837:function(e,t,a){"use strict";a.d(t,{A7:function(){return p},Nq:function(){return c},Sf:function(){return r},WA:function(){return y},XF:function(){return m},YE:function(){return d},fn:function(){return o},iJ:function(){return l},pJ:function(){return u},vt:function(){return x}});var s=a(83464);let i=a(40257).env.NEXT_PUBLIC_API_URL||"http://localhost:5000/api",n=s.Z.create({baseURL:i,headers:{"Content-Type":"application/json"},timeout:1e4,withCredentials:!1});n.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),n.interceptors.response.use(e=>e,e=>{var t,a;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){let t=window.location.pathname;if("/"===t||"/properties"===t||t.startsWith("/properties/")||"/login"===t||"/register"===t)return localStorage.removeItem("token"),localStorage.removeItem("auth-storage"),window.dispatchEvent(new Event("storage")),Promise.reject(e);let s=(null===(a=e.config)||void 0===a?void 0:a.url)||"";(s.includes("/auth/")||s.includes("/wishlist")||s.includes("/admin")||s.includes("/profile"))&&(localStorage.removeItem("token"),localStorage.removeItem("auth-storage"),window.dispatchEvent(new Event("storage")),t.includes("/login")||(window.location.href="/login"))}return Promise.reject(e)});let l={register:e=>n.post("/auth/register",e),login:e=>n.post("/auth/login",e),getProfile:()=>n.get("/auth/profile"),updateProfile:e=>n.put("/auth/profile",e),verifyToken:()=>n.get("/auth/verify")},r={getAll:e=>{let t={};return(null==e?void 0:e.page)&&(t.page=e.page),(null==e?void 0:e.limit)&&(t.limit=e.limit),(null==e?void 0:e.status)&&(t.status=e.status),(null==e?void 0:e.search)&&(t.search=e.search),(null==e?void 0:e.category)&&(t.category=e.category),(null==e?void 0:e.purpose)&&(t.purpose=e.purpose),(null==e?void 0:e.subtype)&&(t.subtype=e.subtype),(null==e?void 0:e.minPrice)&&(t.minPrice=e.minPrice),(null==e?void 0:e.maxPrice)&&(t.maxPrice=e.maxPrice),(null==e?void 0:e.minArea)&&(t.minArea=e.minArea),(null==e?void 0:e.maxArea)&&(t.maxArea=e.maxArea),(null==e?void 0:e.bhk)&&(t.bhk=e.bhk),(null==e?void 0:e.bathrooms)&&(t.bathrooms=e.bathrooms),(null==e?void 0:e.furnishing)&&(t.furnishing=e.furnishing),(null==e?void 0:e.availableFor)&&e.availableFor.length>0&&(t.availableFor=e.availableFor),(null==e?void 0:e.availableFrom)&&(t.availableFrom=e.availableFrom),(null==e?void 0:e.constructionStatus)&&(t.constructionStatus=e.constructionStatus),(null==e?void 0:e.investmentType)&&e.investmentType.length>0&&(t.investmentType=e.investmentType),(null==e?void 0:e.powerCapacity)&&(t.powerCapacity=e.powerCapacity),(null==e?void 0:e.meetingRooms)!==void 0&&(t.meetingRooms=e.meetingRooms),(null==e?void 0:e.pantry)!==void 0&&(t.pantry=e.pantry),(null==e?void 0:e.conferenceRoom)!==void 0&&(t.conferenceRoom=e.conferenceRoom),(null==e?void 0:e.cabins)&&(t.cabins=e.cabins),(null==e?void 0:e.washrooms)&&(t.washrooms=e.washrooms),(null==e?void 0:e.floorPreference)&&(t.floorPreference=e.floorPreference),(null==e?void 0:e.locatedOn)&&(t.locatedOn=e.locatedOn),(null==e?void 0:e.officeSpread)&&(t.officeSpread=e.officeSpread),(null==e?void 0:e.situatedIn)&&(t.situatedIn=e.situatedIn),(null==e?void 0:e.businessType)&&e.businessType.length>0&&(t.businessType=e.businessType),(null==e?void 0:e.city)&&(t.city=e.city),(null==e?void 0:e.state)&&(t.state=e.state),(null==e?void 0:e.locality)&&(t.locality=e.locality),(null==e?void 0:e.amenities)&&e.amenities.length>0&&(t.amenities=e.amenities),(null==e?void 0:e.reraApproved)!==void 0&&(t.reraApproved=e.reraApproved),(null==e?void 0:e.ageOfProperty)&&(t.ageOfProperty=e.ageOfProperty),(null==e?void 0:e.possessionStatus)&&(t.possessionStatus=e.possessionStatus),(null==e?void 0:e.facing)&&(t.facing=e.facing),(null==e?void 0:e.parking)&&(t.parking=e.parking),(null==e?void 0:e.sortBy)&&(t.sortBy=e.sortBy),n.get("/properties",{params:t})},getById:e=>n.get("/properties/".concat(e)),create:e=>n.post("/properties",e),update:(e,t)=>n.put("/properties/".concat(e),t),delete:e=>n.delete("/properties/".concat(e)),search:e=>r.getAll({...e,page:e.page,limit:e.limit}),getSimilar:(e,t)=>n.get("/properties/".concat(e,"/similar"),{params:{limit:t}})},o={create:e=>n.post("/leads",e),getAll:e=>n.get("/leads",{params:e}),getById:e=>n.get("/leads/".concat(e)),updateStatus:(e,t)=>n.put("/leads/".concat(e,"/status"),{status:t}),delete:e=>n.delete("/leads/".concat(e)),exportCSV:()=>n.get("/leads/export/csv",{responseType:"blob"})},d={getAll:()=>n.get("/wishlist"),add:e=>n.post("/wishlist",{property_id:e}),remove:e=>n.delete("/wishlist/".concat(e))},c={getDashboard:()=>n.get("/admin/dashboard"),getUsers:e=>n.get("/admin/users",{params:e}),updateUserStatus:(e,t)=>n.put("/admin/users/".concat(e,"/status"),{is_active:t}),updateUserRole:(e,t)=>n.put("/admin/users/".concat(e,"/role"),{role:t}),deleteUser:e=>n.delete("/admin/users/".concat(e)),getAnalytics:e=>n.get("/admin/analytics",{params:e}),getSettings:()=>n.get("/admin/settings"),updateSettings:e=>n.put("/admin/settings",e)},u={getPublicSettings:()=>n.get("/admin/settings/public")},m={upload:e=>{let t=new FormData;t.append("file",e);let a=e.type.startsWith("video/");return n.post("/media/upload",t,{headers:{"Content-Type":"multipart/form-data"},timeout:a?6e5:3e4,onUploadProgress:e=>{e.total&&(e.loaded,e.total)}})},uploadMultiple:e=>{let t=new FormData;e.forEach(e=>t.append("files",e));let a=e.some(e=>e.type.startsWith("video/"));return n.post("/media/upload/multiple",t,{headers:{"Content-Type":"multipart/form-data"},timeout:a?6e5:3e4})}},x={search:e=>n.get("/locations",{params:{query:e}})},p={getAll:()=>n.get("/drafts"),create:e=>n.post("/drafts",e),update:(e,t)=>n.put("/drafts/".concat(e),t),delete:e=>n.delete("/drafts/".concat(e))},y={getAll:()=>n.get("/amenities"),create:e=>n.post("/amenities",e),update:(e,t)=>n.put("/amenities/".concat(e),t),delete:e=>n.delete("/amenities/".concat(e))}},1217:function(e,t,a){"use strict";a.d(t,{t:function(){return n}});var s=a(59625),i=a(89134);let n=(0,s.Ue)()((0,i.tJ)(e=>({user:null,token:null,isAuthenticated:!1,setAuth:(t,a)=>{localStorage.setItem("token",a),e({user:t,token:a,isAuthenticated:!0})},clearAuth:()=>{localStorage.removeItem("token"),e({user:null,token:null,isAuthenticated:!1})},updateUser:t=>e(e=>({user:e.user?{...e.user,...t}:null}))}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))}},function(e){e.O(0,[655,230,713,883,34,971,117,744],function(){return e(e.s=51326)}),_N_E=e.O()}]);