(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{1247:function(e,t,s){Promise.resolve().then(s.bind(s,33058))},92735:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},73247:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(39763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},33058:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var a=s(57437),i=s(2265),r=s(99376),n=s(29827),l=s(11713),o=s(21770),c=s(71837),d=s(1217),u=s(15863),x=s(92735),m=s(73247),p=s(18930),h=s(40521),y=s(69064);function v(){let e=(0,r.useRouter)(),{isAuthenticated:t,user:s}=(0,d.t)(),v=(0,n.NL)(),[j,f]=(0,i.useState)(1),[N,b]=(0,i.useState)(""),[g,w]=(0,i.useState)("");(0,i.useEffect)(()=>{t&&(null==s?void 0:s.role)==="admin"||e.push("/")},[t,s,e]);let{data:S,isLoading:k}=(0,l.a)({queryKey:["admin-users",j,N,g],queryFn:async()=>(await c.Nq.getUsers({page:j,limit:20,search:N||void 0,role:g||void 0})).data,enabled:t&&(null==s?void 0:s.role)==="admin"}),C=(0,o.D)({mutationFn:e=>{let{id:t,is_active:s}=e;return c.Nq.updateUserStatus(t,s)},onSuccess:()=>{v.invalidateQueries({queryKey:["admin-users"]}),y.ZP.success("User status updated successfully")},onError:e=>{var t,s;y.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to update user status")}}),U=(0,o.D)({mutationFn:e=>{let{id:t,role:s}=e;return c.Nq.updateUserRole(t,s)},onSuccess:()=>{v.invalidateQueries({queryKey:["admin-users"]}),y.ZP.success("User role updated successfully")},onError:e=>{var t,s;y.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to update user role")}}),Z=(0,o.D)({mutationFn:e=>c.Nq.deleteUser(e),onSuccess:()=>{v.invalidateQueries({queryKey:["admin-users"]}),y.ZP.success("User deleted successfully")},onError:e=>{var t,s;y.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to delete user")}});if(k)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"animate-spin text-accent-primary",size:32})});let E=(null==S?void 0:S.users)||[],P=(null==S?void 0:S.pagination)||{page:1,limit:20,total:0,pages:1};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-soft p-6",children:(0,a.jsxs)("div",{className:"max-w-[1280px] mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-4xl font-display font-bold text-text-primary mb-2",children:"User Management"}),(0,a.jsx)("p",{className:"text-text-secondary",children:"Manage users and their permissions"})]}),(0,a.jsxs)("button",{onClick:()=>{let e=new Blob([["Name,Email,Phone,Role,Status,Created At",...E.map(e=>[e.name||"",e.email||"",e.phone||"N/A",e.role||"user",e.is_active?"Active":"Inactive",new Date(e.created_at||Date.now()).toLocaleDateString()]).map(e=>e.map(e=>'"'.concat(e,'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="solomon-users-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),y.ZP.success("Users exported to CSV successfully")},className:"bg-[#5B5F97] text-white rounded-md px-3 py-2 text-sm font-semibold hover:bg-[#7A80B8] transition-colors flex items-center gap-2",children:[(0,a.jsx)(x.Z,{size:16}),"Export CSV"]})]}),(0,a.jsx)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card-luxury p-6 mb-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-secondary",size:18}),(0,a.jsx)("input",{type:"text",placeholder:"Search users...",value:N,onChange:e=>b(e.target.value),className:"input-elegant w-full pl-10"})]}),(0,a.jsxs)("select",{value:g,onChange:e=>w(e.target.value),className:"input-elegant",children:[(0,a.jsx)("option",{value:"",children:"All Roles"}),(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})]})}),(0,a.jsxs)(h.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card-luxury p-6",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-border",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Name"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Email"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Phone"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Role"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-text-primary",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:E.length>0?E.map(e=>(0,a.jsxs)("tr",{className:"border-b border-border hover:bg-surface-muted",children:[(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.name}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.email}),(0,a.jsx)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:e.phone||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("select",{value:e.role,onChange:t=>{U.mutate({id:e.id,role:t.target.value})},className:"input-elegant text-sm",disabled:U.isPending,children:[(0,a.jsx)("option",{value:"user",children:"User"}),(0,a.jsx)("option",{value:"admin",children:"Admin"})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("button",{onClick:()=>{C.mutate({id:e.id,is_active:!e.is_active})},className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(e.is_active?"bg-success/20 text-success":"bg-error/20 text-error"),disabled:C.isPending,children:e.is_active?"Active":"Inactive"})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to delete this user?")&&Z.mutate(e.id)},className:"text-error hover:text-error/80 transition-colors",disabled:Z.isPending,children:(0,a.jsx)(p.Z,{size:18})})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"py-8 text-center text-text-secondary",children:"No users found"})})})]})}),P.pages>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,a.jsxs)("p",{className:"text-text-secondary text-sm",children:["Showing ",(P.page-1)*P.limit+1," to ",Math.min(P.page*P.limit,P.total)," of ",P.total," users"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===j,className:"btn-secondary",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>f(e=>Math.min(P.pages,e+1)),disabled:j===P.pages,className:"btn-secondary",children:"Next"})]})]})]})]})})}}},function(e){e.O(0,[655,230,713,883,64,823,971,117,744],function(){return e(e.s=1247)}),_N_E=e.O()}]);